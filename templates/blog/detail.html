{% extends "base.html" %}
{% load static blog_extras %}

{% block meta %}
    <meta name="description" content="{{ post.seo_description|default:post.excerpt|default:post.title }}">
    <link rel="canonical" href="{{ post.canonical_url|default:request.build_absolute_uri }}">
    <meta property="og:title" content="{{ post.title }}">
    <meta property="og:description" content="{{ post.seo_description|default:post.excerpt|default:post.title }}">
    {% if post.cover_image %}
        <meta property="og:image" content="{{ post.cover_image.url|build_absolute_uri }}">
    {% endif %}
{% endblock %}

{% block content %}
    <article class="b-container blog-detail">
        <header class="post-header">
            <h1 class="h-xl">{{ post.title }}</h1>
            <p class="muted post-meta">
                {{ post.publish_at|date:"M d, Y" }} · {{ post.reading_time }} min read
                {% if post.category %} ·
                    <a href="{% url 'blog:category' post.category.slug %}">{{ post.category.name }}</a>{% endif %}
            </p>

            {% if post.cover_image %}
                <img
                        src="{{ post.cover_image.url|build_absolute_uri }}"
                        alt="{{ post.title }}"
                        loading="lazy"
                        data-name="{{ post.cover_image.name }}"
                        data-url="{{ post.cover_image.url }}"
                >
                <script>
                    console.group("[Detail]");
                    console.log("name:", "{{ post.cover_image.name|escapejs }}");
                    console.log("url:", "{{ post.cover_image.url|escapejs }}");                  // should be /media/blog/...
                    console.log("abs:", "{{ post.cover_image.url|build_absolute_uri|escapejs }}"); // https://bambicim.com/media/...
                    console.groupEnd();
                </script>
            {% else %}
                <script>console.warn("[Detail] no cover_image");</script>
            {% endif %}
        </header>

        <div class="post-content prose">
            {{ post.content|markdownify|safe }}
        </div>
    </article>
{% endblock %}
